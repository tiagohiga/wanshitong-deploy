"use strict";(self.webpackChunkwst_front=self.webpackChunkwst_front||[]).push([[702],{7702:(pt,v,i)=>{i.r(v),i.d(v,{BorrowModule:()=>ct});var m=i(6814),p=i(2787),x=i(6306),E=i(2096),A=i(8326),t=i(5879),D=i(1374),h=i(7337),y=i(9862);let w=(()=>{class o{constructor(e){this.httpClient=e,this.API="v1/emprestimos",this.API_ID="v1/emprestimos/emprestimo",this.API_EDIT="v1/emprestimos/baixar",this.BASE_URL=h.N.baseUrl}listAll(){return this.httpClient.get(`${this.BASE_URL}`+this.API).pipe((0,D.P)())}loadById(e){return this.httpClient.get(`${this.BASE_URL}${this.API_ID}/${e}`)}update(e,r){return this.httpClient.put(`${this.BASE_URL}${this.API_EDIT}/${r}`,e)}save(e){return this.httpClient.post(`${this.BASE_URL}`+this.API,e)}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(y.eN))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var U=i(7700),u=i(5195),g=i(1274),k=i(5940),l=i(5313),_=i(2296),b=i(617),f=i(9157),Z=i(2032);function M(o,n){1&o&&(t.TgZ(0,"mat-header-cell"),t._uU(1,"C\xf3digo"),t.qZA())}function O(o,n){if(1&o&&(t.TgZ(0,"mat-cell"),t._uU(1),t.qZA()),2&o){const e=n.$implicit;t.xp6(1),t.Oqu(e.idEmprestimo)}}function N(o,n){1&o&&(t.TgZ(0,"mat-header-cell"),t._uU(1,"Solicitante"),t.qZA())}function S(o,n){if(1&o&&(t.TgZ(0,"mat-cell"),t._uU(1),t.qZA()),2&o){const e=n.$implicit;t.xp6(1),t.Oqu(e.usuario.emailUsuario)}}function L(o,n){1&o&&(t.TgZ(0,"mat-header-cell"),t._uU(1,"Status"),t.qZA())}function Y(o,n){if(1&o&&(t.TgZ(0,"mat-cell"),t._uU(1),t.qZA()),2&o){const e=n.$implicit;t.xp6(1),t.Oqu(e.statusEmprestimo)}}function P(o,n){1&o&&(t.TgZ(0,"mat-header-cell"),t._uU(1,"Realizado em"),t.qZA())}function z(o,n){if(1&o&&(t.TgZ(0,"mat-cell"),t._uU(1),t.qZA()),2&o){const e=n.$implicit;t.xp6(1),t.Oqu(e.dataEmprestimo)}}function I(o,n){1&o&&(t.TgZ(0,"mat-header-cell"),t._uU(1,"Prazo para Devolu\xe7\xe3o"),t.qZA())}function F(o,n){if(1&o&&(t.TgZ(0,"mat-cell"),t._uU(1),t.qZA()),2&o){const e=n.$implicit;t.xp6(1),t.Oqu(e.prazoDevolucao)}}function J(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"mat-header-cell",15)(1,"button",16),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.onAdd())}),t.TgZ(2,"mat-icon"),t._uU(3,"shopping_cart_checkout"),t.qZA()()()}}function R(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"mat-cell",17)(1,"button",18),t.NdJ("click",function(){const a=t.CHM(e).$implicit,c=t.oxw();return t.KtG(c.onView(a))}),t.TgZ(2,"mat-icon"),t._uU(3,"remove_red_eye"),t.qZA()()()}}function q(o,n){1&o&&t._UZ(0,"mat-header-row")}function $(o,n){1&o&&t._UZ(0,"mat-row")}let Q=(()=>{class o{constructor(){this.borrows=[],this.view=new t.vpe(!1),this.add=new t.vpe(!1),this.displayedColumns=["idEmprestimo","statusEmprestimo","dataEmprestimo","prazoDevolucao","actions"],this.dataSource=new l.by}ngOnInit(){this.dataSource.data=this.borrows}onAdd(){this.add.emit(!0)}onView(e){this.view.emit(e)}applyFilter(e){this.dataSource.filter=e.target.value.trim().toLowerCase()}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-borrows-list"]],inputs:{borrows:"borrows"},outputs:{view:"view",add:"add"},decls:26,vars:3,consts:[["matInput","","placeholder","1",3,"keyup"],["input",""],[3,"dataSource"],["matColumnDef","idEmprestimo"],[4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","usuario"],["matColumnDef","statusEmprestimo"],["matColumnDef","dataEmprestimo"],["matColumnDef","prazoDevolucao"],["matColumnDef","actions"],["class","action-column-header",4,"matHeaderCellDef"],["class","action-column",4,"matCellDef"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],[1,"action-column-header"],["mat-mini-fab","","color","primary","aria-label","Adicionar um livro",3,"click"],[1,"action-column"],["mat-icon-button","","color","primary","aria-label","Visualizar um emprestimo",3,"click"]],template:function(e,r){1&e&&(t.TgZ(0,"mat-form-field")(1,"mat-label"),t._uU(2,"Buscar"),t.qZA(),t.TgZ(3,"input",0,1),t.NdJ("keyup",function(a){return r.applyFilter(a)}),t.qZA()(),t.TgZ(5,"mat-table",2),t.ynx(6,3),t.YNc(7,M,2,0,"mat-header-cell",4),t.YNc(8,O,2,1,"mat-cell",5),t.BQk(),t.ynx(9,6),t.YNc(10,N,2,0,"mat-header-cell",4),t.YNc(11,S,2,1,"mat-cell",5),t.BQk(),t.ynx(12,7),t.YNc(13,L,2,0,"mat-header-cell",4),t.YNc(14,Y,2,1,"mat-cell",5),t.BQk(),t.ynx(15,8),t.YNc(16,P,2,0,"mat-header-cell",4),t.YNc(17,z,2,1,"mat-cell",5),t.BQk(),t.ynx(18,9),t.YNc(19,I,2,0,"mat-header-cell",4),t.YNc(20,F,2,1,"mat-cell",5),t.BQk(),t.ynx(21,10),t.YNc(22,J,4,0,"mat-header-cell",11),t.YNc(23,R,4,0,"mat-cell",12),t.BQk(),t.YNc(24,q,1,0,"mat-header-row",13),t.YNc(25,$,1,0,"mat-row",14),t.qZA()),2&e&&(t.xp6(5),t.Q6J("dataSource",r.dataSource),t.xp6(19),t.Q6J("matHeaderRowDef",r.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",r.displayedColumns))},dependencies:[l.BZ,l.fO,l.as,l.w1,l.Dz,l.nj,l.ge,l.ev,l.XQ,l.Gk,_.RK,_.nh,b.Hw,f.KE,f.hX,Z.Nt],styles:["mat-table[_ngcontent-%COMP%]{overflow:auto;max-height:600px}.action-column[_ngcontent-%COMP%], .action-column-header[_ngcontent-%COMP%]{flex:0 0 75px}.link-button[_ngcontent-%COMP%]{background:none!important;border:none;padding:0!important;color:#069;text-decoration:underline;cursor:pointer}mat-form-field[_ngcontent-%COMP%]{overflow:auto;width:100%}"]}),o})();function j(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"app-borrows-list",4),t.NdJ("view",function(s){t.CHM(e);const a=t.oxw();return t.KtG(a.onView(s))})("add",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.onAdd())}),t.qZA()}2&o&&t.Q6J("borrows",n.ngIf)}function H(o,n){1&o&&(t.TgZ(0,"div",5),t._UZ(1,"mat-spinner"),t.qZA())}let K=(()=>{class o{constructor(e,r,s,a){this.borrowEmprestimo=e,this.dialog=r,this.router=s,this.route=a,this.borrows$=this.borrowEmprestimo.listAll().pipe((0,x.K)(c=>(this.onError("Erro ao carregar emprestimos."),(0,E.of)([]))))}onError(e){this.dialog.open(A.I,{data:e})}onView(e){this.router.navigate(["view",e.idEmprestimo],{relativeTo:this.route})}onAdd(){console.log("Cart"),this.router.navigate(["cart"],{relativeTo:this.route})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(w),t.Y36(U.uw),t.Y36(p.F0),t.Y36(p.gz))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-borrow"]],decls:8,vars:4,consts:[["color","primary"],[1,"column-flex","mat-elevation-z8"],[3,"borrows","view","add",4,"ngIf","ngIfElse"],["loading",""],[3,"borrows","view","add"],[1,"loading-spinner"]],template:function(e,r){if(1&e&&(t.TgZ(0,"mat-card")(1,"mat-toolbar",0),t._uU(2," Emprestimos Realizados"),t.qZA(),t.TgZ(3,"div",1),t.YNc(4,j,1,1,"app-borrows-list",2),t.ALo(5,"async"),t.YNc(6,H,2,0,"ng-template",null,3,t.W1O),t.qZA()()),2&e){const s=t.MAs(7);t.xp6(4),t.Q6J("ngIf",t.lcZ(5,2,r.borrows$))("ngIfElse",s)}},dependencies:[m.O5,u.a8,g.Ye,k.Ou,Q,m.Ov]}),o})();var B=i(2939),T=i(6385),d=i(9038);function G(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"mat-list-option",6),t.NdJ("click",function(s){const c=t.CHM(e).$implicit,mt=t.oxw();return t.KtG(mt.onCheckboxChange(c.isbn,s))}),t._uU(1),t.qZA()}if(2&o){const e=n.$implicit;t.xp6(1),t.hij(" ",e.isbn," ")}}function V(o,n){if(1&o&&(t.ynx(0),t.TgZ(1,"mat-list-item")(2,"span",7),t._uU(3),t.qZA(),t.TgZ(4,"span",8),t._uU(5),t.qZA()(),t.BQk()),2&o){const e=n.$implicit;t.xp6(3),t.hij("ISBN: ",e.isbn,""),t.xp6(2),t.hij("Devolvido em: ",e.dataDevolucao,"")}}let X=(()=>{class o{constructor(e,r,s,a){this.borrowService=e,this.snackBar=r,this.location=s,this.route=a,this.displayedColumns=["isbn","dataDevolucao"],this.checkedList=[],this.idEmprestimo=0,this.nomeUsuario="",this.bibliotecario="",this.statusEmprestimo="",this.dataEmprestimo="",this.prazoDevolucao="",this.livros=[],this.livrosDevolvidos=[]}ngOnInit(){this.route.params.subscribe(e=>{this.borrowService.loadById(e.id).subscribe(a=>{this.idEmprestimo=a.id,this.nomeUsuario=a.nomeUsuario,this.bibliotecario=a.bibliotecario,this.statusEmprestimo=a.statusEmprestimo,this.dataEmprestimo=a.dataEmprestimo,this.prazoDevolucao=a.prazoDevolucao;for(var c=0;c<a.livros.length;c++)null===a.livros[c].dataDevolucao?this.livros.push(a.livros[c]):this.livrosDevolvidos.push(a.livros[c])})})}onSubmit(){this.borrowService.update({email:this.nomeUsuario,bibliotecario:h.N.email,isbnLivros:this.checkedList},this.idEmprestimo).subscribe(r=>this.onSuccess(),r=>{this.onError()}),this.location.back()}onSuccess(){this.snackBar.open("Atualiza\xe7\xe3o enviada com sucesso","",{duration:3e3}),this.onCancel()}onError(){this.snackBar.open("Erro ao atualizar Emprestimo","",{duration:3e3})}onCancel(){this.location.back()}onCheckboxChange(e,r){this.checkedList.includes(e)?this.checkedList.forEach((s,a)=>{s===e&&this.checkedList.splice(a,1)}):this.checkedList.push(e)}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(w),t.Y36(B.ux),t.Y36(m.Ye),t.Y36(p.gz))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-borrow-detail"]],decls:35,vars:7,consts:[["color","primary"],[1,"font-size-20"],[3,"click",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["mat-raised-button","","color","primary",3,"click"],["mat-raised-button","",3,"click"],[3,"click"],["matListItemTitle",""],["matListItemLine",""]],template:function(e,r){1&e&&(t.TgZ(0,"mat-card")(1,"mat-toolbar",0)(2,"mat-toolbar-row")(3,"span"),t._uU(4),t.qZA()()(),t.TgZ(5,"mat-card-header")(6,"mat-card-subtitle",1),t._uU(7),t.qZA(),t.TgZ(8,"mat-card-subtitle",1),t._uU(9),t.qZA(),t.TgZ(10,"mat-card-subtitle",1),t._uU(11),t.qZA(),t.TgZ(12,"mat-card-subtitle",1),t._uU(13),t.qZA()(),t._UZ(14,"mat-divider"),t.TgZ(15,"mat-card-content")(16,"section")(17,"h3"),t._uU(18,"Livros"),t.qZA(),t.TgZ(19,"h4"),t._uU(20,"Em aberto"),t.qZA(),t.TgZ(21,"mat-selection-list"),t.YNc(22,G,2,1,"mat-list-option",2),t.qZA(),t._UZ(23,"mat-divider"),t.TgZ(24,"h4"),t._uU(25,"Devolvidos"),t.qZA(),t.TgZ(26,"div")(27,"mat-list"),t.YNc(28,V,6,2,"ng-container",3),t.qZA()()()(),t._UZ(29,"mat-divider"),t.TgZ(30,"mat-card-actions")(31,"button",4),t.NdJ("click",function(){return r.onSubmit()}),t._uU(32," Finalizar "),t.qZA(),t.TgZ(33,"button",5),t.NdJ("click",function(){return r.onCancel()}),t._uU(34,"Voltar"),t.qZA()()()),2&e&&(t.xp6(4),t.hij("# ",r.idEmprestimo,""),t.xp6(3),t.hij("Solicitante: ",r.nomeUsuario,""),t.xp6(2),t.hij("Status do Empr\xe9stimo: ",r.statusEmprestimo,""),t.xp6(2),t.hij("Data de Realiza\xe7\xe3o: ",r.dataEmprestimo,""),t.xp6(2),t.hij("Prazo m\xe1ximo para Devolu\xe7\xe3o: ",r.prazoDevolucao,""),t.xp6(9),t.Q6J("ngForOf",r.livros),t.xp6(6),t.Q6J("ngForOf",r.livrosDevolvidos))},dependencies:[m.sg,u.a8,u.hq,u.dn,u.dk,u.$j,g.Ye,g.rD,_.lW,T.d,d.i$,d.Ub,d.Tg,d.vS,d.WW,d.sL],styles:["img[_ngcontent-%COMP%]{width:100%}mat-card-content[_ngcontent-%COMP%]{margin:10px}mat-card-actions[_ngcontent-%COMP%]{justify-content:center}button[_ngcontent-%COMP%]{margin:10px}p[_ngcontent-%COMP%], .font-size-20[_ngcontent-%COMP%]{font-size:20px}.font-size-15[_ngcontent-%COMP%]{font-size:15px}mat-divider[_ngcontent-%COMP%]{padding:5px;margin-top:10px}mat-card-subtitle[_ngcontent-%COMP%]{margin:5px}"]}),o})();var C=i(6223);function W(o,n){1&o&&(t.TgZ(0,"mat-header-cell"),t._uU(1,"ISBN"),t.qZA())}function tt(o,n){if(1&o&&(t.TgZ(0,"mat-cell"),t._uU(1),t.qZA()),2&o){const e=n.$implicit;t.xp6(1),t.Oqu(e)}}function ot(o,n){1&o&&(t.TgZ(0,"mat-header-cell",14),t._uU(1," A\xe7\xf5es "),t.qZA())}function et(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"mat-cell",15)(1,"button",16),t.NdJ("click",function(){const a=t.CHM(e).index,c=t.oxw();return t.KtG(c.onRemove(a))}),t.TgZ(2,"mat-icon"),t._uU(3,"cancel"),t.qZA()()()}}function nt(o,n){1&o&&t._UZ(0,"mat-header-row")}function rt(o,n){1&o&&t._UZ(0,"mat-row")}const at=[{path:"",component:K},{path:"view/:id",component:X},{path:"cart",component:(()=>{class o{constructor(e,r,s,a){this.borrowService=e,this.snackBar=r,this.location=s,this.route=a,this.data=[],this.email="",this.dataSource=new l.by,this.displayedColumns=["isbn","actions"]}ngOnInit(){this.data=h.N.livrosEmprestimo.filter(Boolean),this.updateDataSource(),console.log(this.data)}onRemove(e){this.data.splice(e,1),this.updateDataSource()}updateDataSource(){this.dataSource.data=this.data,h.N.livrosEmprestimo=this.data}onSave(){this.borrowService.save({email:this.email,bibliotecario:h.N.email,isbnLivros:this.data}).subscribe(r=>this.onSuccess(),r=>{this.onError()}),this.location.back()}onCancel(){this.location.back()}onSuccess(){this.snackBar.open("Emprestimo com sucesso","",{duration:3e3}),this.onCancel()}onError(){this.snackBar.open("Erro ao realizar Emprestimo","",{duration:3e3})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(w),t.Y36(B.ux),t.Y36(m.Ye),t.Y36(p.gz))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-borrow-cart"]],decls:20,vars:4,consts:[["matInput","","placeholder","mail@mail.com",3,"ngModel","ngModelChange"],["input",""],[3,"dataSource"],["matColumnDef","isbn"],[4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","actions"],["class","action-column-header",4,"matHeaderCellDef"],["class","action-column",4,"matCellDef"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],[1,"example-button-row"],["mat-raised-button","","color","primary",3,"click"],["mat-raised-button","","color","accent",3,"click"],[1,"action-column-header"],[1,"action-column"],["mat-icon-button","","color","primary","aria-label","Remover um livro",3,"click"]],template:function(e,r){1&e&&(t.TgZ(0,"mat-form-field")(1,"mat-label"),t._uU(2,"E-mail"),t.qZA(),t.TgZ(3,"input",0,1),t.NdJ("ngModelChange",function(a){return r.email=a}),t.qZA()(),t.TgZ(5,"mat-table",2),t.ynx(6,3),t.YNc(7,W,2,0,"mat-header-cell",4),t.YNc(8,tt,2,1,"mat-cell",5),t.BQk(),t.ynx(9,6),t.YNc(10,ot,2,0,"mat-header-cell",7),t.YNc(11,et,4,0,"mat-cell",8),t.BQk(),t.YNc(12,nt,1,0,"mat-header-row",9),t.YNc(13,rt,1,0,"mat-row",10),t.qZA(),t._UZ(14,"mat-divider"),t.TgZ(15,"div",11)(16,"button",12),t.NdJ("click",function(){return r.onSave()}),t._uU(17,"Confirmar"),t.qZA(),t.TgZ(18,"button",13),t.NdJ("click",function(){return r.onCancel()}),t._uU(19,"Voltar"),t.qZA()()),2&e&&(t.xp6(3),t.Q6J("ngModel",r.email),t.xp6(2),t.Q6J("dataSource",r.dataSource),t.xp6(7),t.Q6J("matHeaderRowDef",r.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",r.displayedColumns))},dependencies:[l.BZ,l.fO,l.as,l.w1,l.Dz,l.nj,l.ge,l.ev,l.XQ,l.Gk,_.lW,_.RK,b.Hw,T.d,f.KE,f.hX,Z.Nt,C.Fj,C.JJ,C.On],styles:["mat-table[_ngcontent-%COMP%]{overflow:auto;max-height:600px}.action-column[_ngcontent-%COMP%], .action-column-header[_ngcontent-%COMP%]{flex:0 0 75px}.link-button[_ngcontent-%COMP%]{background:none!important;border:none;padding:0!important;color:#069;text-decoration:underline;cursor:pointer}mat-form-field[_ngcontent-%COMP%]{overflow:auto;width:100%}section[_ngcontent-%COMP%]{display:table}.example-label[_ngcontent-%COMP%]{display:table-cell;font-size:14px;margin-left:8px;min-width:120px}.example-button-row[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.example-button-row[_ngcontent-%COMP%]   .mat-mdc-button-base[_ngcontent-%COMP%]{margin:8px 8px 8px 0}.example-flex-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between;flex-wrap:wrap}.example-button-container[_ngcontent-%COMP%]{display:flex;justify-content:center;width:120px}"]}),o})()}];let it=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[p.Bz.forChild(at),p.Bz]}),o})();var st=i(893),lt=i(6208);let ct=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[m.ez,it,st.M,lt.m,C.u5]}),o})()}}]);